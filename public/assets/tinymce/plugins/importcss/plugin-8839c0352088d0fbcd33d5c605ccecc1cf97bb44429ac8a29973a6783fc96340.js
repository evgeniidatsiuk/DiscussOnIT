!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),n=tinymce.util.Tools.resolve("tinymce.EditorManager"),r=tinymce.util.Tools.resolve("tinymce.Env"),i=tinymce.util.Tools.resolve("tinymce.util.Tools"),c=function(e){return e.getParam("importcss_merge_classes")},s=function(e){return e.getParam("importcss_exclusive")},o=function(e){return e.getParam("importcss_selector_converter")},u=function(e){return e.getParam("importcss_selector_filter")},l=function(e){return e.getParam("importcss_groups")},a=function(e){return e.getParam("importcss_append")},f=function(e){return e.getParam("importcss_file_filter")},m=function(e){return"string"==typeof e?function(t){return-1!==t.indexOf(e)}:e instanceof RegExp?function(t){return e.test(t)}:e},g=function(e,t,c){function s(t,u){var l,a,f,g=t.href;if(a=g,f=r.cacheSuffix,"string"==typeof a&&(a=a.replace("?"+f,"").replace("&"+f,"")),(g=a)&&c(g,u)&&(v=g,!(d=!1!==(h=(p=e).settings).skin&&(h.skin||"lightgray"))||v!==(h.skin_url?p.documentBaseURI.toAbsolute(h.skin_url):n.baseURL+"/skins/"+d)+"/content"+(p.inline?".inline":"")+".min.css")){var p,v,h,d;i.each(t.imports,function(e){s(e,!0)});try{l=t.cssRules||t.rules}catch(m){}i.each(l,function(e){e.styleSheet?s(e.styleSheet,!0):e.selectorText&&i.each(e.selectorText.split(","),function(e){o.push(i.trim(e))})})}}var o=[],u={};i.each(e.contentCSS,function(e){u[e]=!0}),c||(c=function(e,t){return t||u[e]});try{i.each(t.styleSheets,function(e){s(e)})}catch(d){}return o},p=function(e,t){var n,r=/^(?:([a-z0-9\-_]+))?(\.[a-z0-9_\-\.]+)$/i.exec(t);if(r){var s=r[1],o=r[2].substr(1).split(".").join(" "),u=i.makeMap("a,img");return r[1]?(n={title:t},e.schema.getTextBlockElements()[s]?n.block=s:e.schema.getBlockElements()[s]||u[s.toLowerCase()]?n.selector=s:n.inline=s):r[2]&&(n={inline:"span",title:t.substr(1),classes:o}),!1!==c(e)?n.classes=o:n.attributes={"class":o},n}},v=function(e,t){return null===t||!1!==s(e)},h=p,d=function(e){e.on("renderFormatsMenu",function(n){var r,c={},s=m(u(e)),h=n.control,d=(r=l(e),i.map(r,function(e){return i.extend({},e,{original:e,selectors:{},filter:m(e.filter),item:{text:e.title,menu:[]}})})),y=function(n,r){if(_=n,T=c,!(v(e,x=r)?_ in T:_ in x.selectors)){g=n,y=c,v(e,d=r)?y[g]=!0:d.selectors[g]=!0;var s=(a=(l=e).plugins.importcss,f=n,((m=r)&&m.selector_converter?m.selector_converter:o(l)?o(l):function(){return p(l,f)}).call(a,f,m));if(s){var u=s.name||t.DOM.uniqueId();return e.formatter.register(u,s),i.extend({},h.settings.itemDefaults,{text:s.title,format:u})}}var l,a,f,m,g,d,y,_,x,T;return null};a(e)||h.items().remove(),i.each(g(e,n.doc||e.getDoc(),m(f(e))),function(e){if(-1===e.indexOf(".mce-")&&(!s||s(e))){var t=(r=d,c=e,i.grep(r,function(e){return!e.filter||e.filter(c)}));if(0<t.length)i.each(t,function(t){var n=y(e,t);n&&t.item.menu.push(n)});else{var n=y(e,null);n&&h.add(n)}}var r,c}),i.each(d,function(e){0<e.item.menu.length&&h.add(e.item)}),n.control.renderNew()})},y=function(e){return{convertSelectorToFormat:function(t){return h(e,t)}}};e.add("importcss",function(e){return d(e),y(e)})}();